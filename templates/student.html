<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>UPRM Document Management System</title>

    <!-- Bootstrap Core CSS -->
    <link href="../static/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="../static/bower_components/metisMenu/dist/metisMenu.min.css" rel="stylesheet">

    <!-- Timeline CSS -->
    <link href="../static/dist/css/timeline.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../static/dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Morris Charts CSS -->
    <link href="../static/bower_components/morrisjs/morris.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../static/bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- jQuery -->
    <script src="../static/bower_components/jquery/dist/jquery.min.js"></script>

    <!-- Modal Style -->
    <link rel="stylesheet" href="static/css/modal.css">

    <!-- Bootstrap Core JavaScript -->
    <script src="../static/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="../static/bower_components/metisMenu/dist/metisMenu.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="../static/dist/js/sb-admin-2.js"></script>

</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/student">UPRM Document Management System</a>
            </div>
            <!-- /.navbar-header -->

            <ul class="nav navbar-top-links navbar-right">
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-user fa-fw"></i><i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-user">
                        <li><a href="/"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
                        </li>
                    </ul>
                    <!-- /.dropdown-user -->
                </li>
                <!-- /.dropdown -->
            </ul>
            <!-- /.navbar-top-links -->

            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">
                        <li>
                            <a href="#"><i class="fa fa-plus fa-fw"></i> New Document<span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">  
                                <li>
                                    <a href="#" onclick="showAssistantshipModal()">Assistantship Request</a>
                                </li>

                                <li>
                                    <a href="#" onclick="showTravelModal()">Travel Request</a>
                                </li>
                                <!-- <li>
                                    <a href="new_otherDocument.html">Other Document</a>
                                </li> -->
                            </ul>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-folder fa-fw"></i> My Documents<span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li>
                                    <a href="#" onclick="getReceivedAssistantships()">Assistantship Request</a>
                                </li>
                                
                                <li>
                                    <a href="#" onclick="getReceivedTravelRequests()">Travel Requests</a>
                                </li>
                            </ul>
                    </ul>
                </div>
                <!-- /.sidebar-collapse -->
            </div>
        </nav>

        

        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h1 id="page_header" class="page-header">My Documents</h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->

            <div class="btn-group btn-group-justified" role="group" aria-label="...">
                <div class="btn-group" role="group">
                    <button id="documents_received_button" type="button" class="btn btn-default active" onclick="getReceivedDocuments()">Received Documents</button>
                </div>
                <div class="btn-group" role="group">
                    <button id="documents_sent_button" type="button" class="btn btn-default" onclick="getSentDocuments()">Sent Documents</button>
                </div>
            </div>
            <br>

            <!-- The Modal -->
            <div class="row">
                <div id="myModal" class="modal" style="margin-left: 251px; width:1030px;">
                    <!-- Modal content -->
                    <div class="modal-content">
                        <div class="modal-header">
                            <span class="close">Ã—</span>
                            <h2 id="modal_title">Modal Header</h2>
                        </div>
                        <div class="modal-body" id="modal_body"></div>
                        <div class="modal-footer"></div>
                    </div>
                </div>
            </div>

            <!-- /.row -->
             <!-- /.panel-heading -->
            <div class="row" id="received_document_row" style="display: block">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel panel-green"> 
                            <div class="panel-heading" >
                                Received Documents
                            </div>
                            <div class="panel-body">
                                <div class="dataTable_wrapper">
                                    <span id="no_received_documents"></span>
                                    <table class="table table-striped table-bordered table-hover" id="received_document_table">
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row" id="sent_document_row" style="display: none">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel panel-green"> 
                            <div class="panel-heading" >
                                Sent Documents
                            </div>
                            <div class="panel-body">
                                <div class="dataTable_wrapper">
                                    <span id="no_sent_documents"></span>
                                    <table class="table table-striped table-bordered table-hover" id="sent_document_table">
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <button onclick="showSendModal(452349816)">Send</button> -->
            <script>

                // Global variables
                var received_document_table = document.getElementById("received_document_table");
                var sent_document_table = document.getElementById("sent_document_table");
                var received_document_table_header = received_document_table.createTHead();
                var sent_document_table_header = sent_document_table.createTHead();
                
                function insertReceivedDocumentTableHeaders() {

                    var row = received_document_table_header.insertRow(0);
                    var cell = row.insertCell(0);
                    cell.innerHTML = "<strong>Document Name</strong>";
                    cell = row.insertCell(1);
                    cell.innerHTML = "<strong>Requester</strong>";
                    cell = row.insertCell(2);
                    cell.innerHTML = "<strong>Date</strong>";
                    var cell = row.insertCell(3);
                    cell.innerHTML = "<strong>Type</strong>";
                    var cell = row.insertCell(4);
                    cell.innerHTML = "<strong>Status</strong>"; 
                }

                function insertSentDocumentTableHeaders() {

                    var row = sent_document_table_header.insertRow(0);
                    var cell = row.insertCell(0);
                    cell.innerHTML = "<strong>Document Name</strong>";
                    cell = row.insertCell(1);
                    cell.innerHTML = "<strong>Requester</strong>";
                    cell = row.insertCell(2);
                    cell.innerHTML = "<strong>Date</strong>";
                    var cell = row.insertCell(3);
                    cell.innerHTML = "<strong>Type</strong>";
                    var cell = row.insertCell(4);
                    cell.innerHTML = "<strong>Status</strong>";
                }
                

                // Getting table values and inserting them
                $.getJSON('/_getStudentDocuments',
                    function (documents) {
                        
                        var the_documents = documents.documents
                        var received_documents = false; // Used to determine if there are any received

                        console.log(the_documents);
                        // insertReceivedDocumentTableHeaders()
                        if (the_documents.length == 0){
                          $("#no_received_documents").text("No Received Documents");  
                        }

                        // Checking if there are received documents
                        for (var i = 0; i < the_documents.length; i++){
                            if (the_documents[i].sent_status == "received") {
                                received_documents = true;
                                break;
                            }
                        }

                        if (received_documents){
                            insertReceivedDocumentTableHeaders();
                            for (var i = 0; i < the_documents.length; i++){
                                // console.log(the_documents[i]);
                                doc = the_documents[i]
                                var row = received_document_table_header.insertRow(i+1);
                                for (var j = 0; j < 5; j++){
                                    var cell = row.insertCell(j);
                                    if (j == 0){
                                        cell.innerHTML = "<a href=\"/doc_info?id="+doc.id+"\">"+doc.name+"</a>";
                                    }
                                    if (j == 1){
                                        cell.innerHTML = doc.requester;
                                    }
                                    if (j == 2){
                                        cell.innerHTML = doc.date;
                                    }
                                    if (j == 3){
                                        cell.innerHTML = doc.type;
                                    }
                                    if (j == 4){
                                        cell.innerHTML = doc.status;
                                    }
                                }
                            }
                        }
                        else{
                           $("#no_received_documents").text("No Received Documents"); 
                        }    
                    });
                        

                

                function getSentDocuments(){
                    $('#documents_received_button').removeClass("active");
                    $('#documents_sent_button').addClass("active");
                    $('#documents_button').removeClass("active");
                    $("#all_document_row").css("display","none");
                    $("#received_document_row").css("display","none");
                    $("#sent_document_row").css("display","block");

                    $("#sent_document_table tr").remove(); 
                    $("#sent_document_table th").remove(); 

                    $.getJSON('/_getStudentDocuments',
                    function (documents) {
                        
                        var the_documents = documents.documents
                        var sent_documents = false; // Used to determine if there are any received

                        console.log(the_documents);
                        // insertReceivedDocumentTableHeaders()
                        if (the_documents.length == 0){
                          $("#no_sent_documents").text("No Sent Documents");  
                        }

                        // Checking if there are received documents
                        for (var i = 0; i < the_documents.length; i++){
                            if (the_documents[i].sent_status == "sent") {
                                sent_documents = true;
                                break;
                            }
                        }

                        if (sent_documents){
                            insertSentDocumentTableHeaders();
                            for (var i = 0; i < the_documents.length; i++){
                                // console.log(the_documents[i]);
                                doc = the_documents[i]
                                var row = sent_document_table_header.insertRow(i+1);
                                for (var j = 0; j < 5; j++){
                                    var cell = row.insertCell(j);
                                    if (j == 0){
                                        cell.innerHTML = "<a href=\"/doc_info?id="+doc.id+"\">"+doc.name+"</a>";
                                    }
                                    if (j == 1){
                                        cell.innerHTML = doc.requester;
                                    }
                                    if (j == 2){
                                        cell.innerHTML = doc.date;
                                    }
                                    if (j == 3){
                                        cell.innerHTML = doc.type;
                                    }
                                    if (j == 4){
                                        cell.innerHTML = doc.status;
                                    }
                                }
                            }
                        }
                        else{
                           $("#no_sent_documents").text("No Sent Documents"); 
                        }    
                    });
                        
                }

                function getReceivedDocuments(){
                    $('#documents_received_button').addClass("active");
                    $('#documents_sent_button').removeClass("active");
                    $('#documents_button').removeClass("active");
                    $("#all_document_row").css("display","none");
                    $("#received_document_row").css("display","block");
                    $("#sent_document_row").css("display","none");

                    $("#received_document_table tr").remove(); 
                    $("#received_document_table th").remove(); 

                    $.getJSON('/_getStudentDocuments',
                    function (documents) {
                        
                        var the_documents = documents.documents
                        var received_documents = false; // Used to determine if there are any received

                        console.log(the_documents);
                        // insertReceivedDocumentTableHeaders()
                        if (the_documents.length == 0){
                          $("#no_received_documents").text("No Received Documents");  
                        }

                        // Checking if there are received documents
                        for (var i = 0; i < the_documents.length; i++){
                            if (the_documents[i].sent_status == "received") {
                                received_documents = true;
                                break;
                            }
                        }

                        if (received_documents){
                            insertReceivedDocumentTableHeaders();
                            for (var i = 0; i < the_documents.length; i++){
                                // console.log(the_documents[i]);
                                doc = the_documents[i]
                                var row = received_document_table_header.insertRow(i+1);
                                for (var j = 0; j < 5; j++){
                                    var cell = row.insertCell(j);
                                    if (j == 0){
                                        cell.innerHTML = "<a href=\"/doc_info?id="+doc.id+"\">"+doc.name+"</a>";
                                    }
                                    if (j == 1){
                                        cell.innerHTML = doc.requester;
                                    }
                                    if (j == 2){
                                        cell.innerHTML = doc.date;
                                    }
                                    if (j == 3){
                                        cell.innerHTML = doc.type;
                                    }
                                    if (j == 4){
                                        cell.innerHTML = doc.status;
                                    }
                                }
                            }
                        }
                        else{
                           $("#no_received_documents").text("No Received Documents"); 
                        }    
                    });
                        
                }

                function goToSend(user_type,doc_id) {
                    // Function that executes when user presses the send button
                   $.get('/send', 
                        { user_type: user_type,
                          document_id: doc_id},
                        function (user) {
                            console.log(user);
                      });
                }

                function getSentAssistantships(){
                    $('#documents_received_button').removeClass("active");
                    $('#documents_sent_button').addClass("active");
                    $('#documents_button').removeClass("active");
                    $("#all_document_row").css("display","none");
                    $("#received_document_row").css("display","none");
                    $("#sent_document_row").css("display","block");

                    $("#sent_document_table tr").remove(); 
                    $("#sent_document_table th").remove(); 
                    $("#page_header").text("Assistantship Requests");

                    $.getJSON('/_getStudentAssistantships',
                    function (documents) {
                        
                        var the_documents = documents.documents
                        var sent_documents = false; // Used to determine if there are any received

                        console.log(the_documents);
                        // insertReceivedDocumentTableHeaders()
                        if (the_documents.length == 0){
                          $("#no_sent_documents").text("No Sent Documents");  
                        }

                        // Checking if there are received documents
                        for (var i = 0; i < the_documents.length; i++){
                            if (the_documents[i].sent_status == "sent") {
                                sent_documents = true;
                                break;
                            }
                        }

                        if (sent_documents){
                            insertSentDocumentTableHeaders();
                            for (var i = 0; i < the_documents.length; i++){
                                // console.log(the_documents[i]);
                                doc = the_documents[i]
                                var row = sent_document_table_header.insertRow(i+1);
                                for (var j = 0; j < 5; j++){
                                    var cell = row.insertCell(j);
                                    if (j == 0){
                                        cell.innerHTML = "<a href=\"/doc_info?id="+doc.id+"\">"+doc.name+"</a>";
                                    }
                                    if (j == 1){
                                        cell.innerHTML = doc.requester;
                                    }
                                    if (j == 2){
                                        cell.innerHTML = doc.date;
                                    }
                                    if (j == 3){
                                        cell.innerHTML = doc.type;
                                    }
                                    if (j == 4){
                                        cell.innerHTML = doc.status;
                                    }
                                }
                            }
                        }
                        else{
                           $("#no_sent_documents").text("No Sent Documents"); 
                        }    
                    });
                        
                }

                function getReceivedAssistantships(){
                    $('#documents_received_button').addClass("active");
                    $('#documents_sent_button').removeClass("active");
                    $('#documents_button').removeClass("active");
                    $("#all_document_row").css("display","none");
                    $("#received_document_row").css("display","block");
                    $("#sent_document_row").css("display","none");

                    $("#received_document_table tr").remove(); 
                    $("#received_document_table th").remove();
                    $("#page_header").text("Assistantship Requests"); 

                    $("#documents_sent_button").attr("onclick","getSentAssistantships()");
                    $("#documents_received_button").attr("onclick","getReceivedAssistantships()");

                    $.getJSON('/_getStudentAssistantships',
                    function (documents) {
                        
                        var the_documents = documents.documents
                        var sent_documents = false; // Used to determine if there are any received

                        console.log(the_documents);
                        // insertReceivedDocumentTableHeaders()
                        if (the_documents.length == 0){
                          $("#no_sent_documents").text("No Sent Documents");  
                        }

                        // Checking if there are received documents
                        for (var i = 0; i < the_documents.length; i++){
                            if (the_documents[i].sent_status == "sent") {
                                sent_documents = true;
                                break;
                            }
                        }

                        if (sent_documents){
                            insertSentDocumentTableHeaders();
                            for (var i = 0; i < the_documents.length; i++){
                                // console.log(the_documents[i]);
                                doc = the_documents[i]
                                var row = sent_document_table_header.insertRow(i+1);
                                for (var j = 0; j < 5; j++){
                                    var cell = row.insertCell(j);
                                    if (j == 0){
                                        cell.innerHTML = "<a href=\"/doc_info?id="+doc.id+"\">"+doc.name+"</a>";
                                    }
                                    if (j == 1){
                                        cell.innerHTML = doc.requester;
                                    }
                                    if (j == 2){
                                        cell.innerHTML = doc.date;
                                    }
                                    if (j == 3){
                                        cell.innerHTML = doc.type;
                                    }
                                    if (j == 4){
                                        cell.innerHTML = doc.status;
                                    }
                                }
                            }
                        }
                        else{
                           $("#no_sent_documents").text("No Sent Documents"); 
                        }    
                    });
                        
                }

                function getSentTravelRequests(){
                    $('#documents_received_button').removeClass("active");
                    $('#documents_sent_button').addClass("active");
                    $('#documents_button').removeClass("active");
                    $("#all_document_row").css("display","none");
                    $("#received_document_row").css("display","none");
                    $("#sent_document_row").css("display","block");

                    $("#sent_document_table tr").remove(); 
                    $("#sent_document_table th").remove();
                    $("#page_header").text("Travel Requests"); 

                    $.getJSON('/_getStudentTravelRequests',
                    function (documents) {
                        
                        var the_documents = documents.documents
                        var sent_documents = false; // Used to determine if there are any received

                        console.log(the_documents);
                        // insertReceivedDocumentTableHeaders()
                        if (the_documents.length == 0){
                          $("#no_sent_documents").text("No Sent Documents");  
                        }

                        // Checking if there are received documents
                        for (var i = 0; i < the_documents.length; i++){
                            if (the_documents[i].sent_status == "sent") {
                                sent_documents = true;
                                break;
                            }
                        }

                        if (sent_documents){
                            insertSentDocumentTableHeaders();
                            for (var i = 0; i < the_documents.length; i++){
                                // console.log(the_documents[i]);
                                doc = the_documents[i]
                                var row = sent_document_table_header.insertRow(i+1);
                                for (var j = 0; j < 5; j++){
                                    var cell = row.insertCell(j);
                                    if (j == 0){
                                        cell.innerHTML = "<a href=\"/doc_info?id="+doc.id+"\">"+doc.name+"</a>";
                                    }
                                    if (j == 1){
                                        cell.innerHTML = doc.requester;
                                    }
                                    if (j == 2){
                                        cell.innerHTML = doc.date;
                                    }
                                    if (j == 3){
                                        cell.innerHTML = doc.type;
                                    }
                                    if (j == 4){
                                        cell.innerHTML = doc.status;
                                    }
                                }
                            }
                        }
                        else{
                           $("#no_sent_documents").text("No Sent Documents"); 
                        }    
                    });
                        
                }

                function getReceivedTravelRequests(){
                    $('#documents_received_button').addClass("active");
                    $('#documents_sent_button').removeClass("active");
                    $('#documents_button').removeClass("active");
                    $("#all_document_row").css("display","none");
                    $("#received_document_row").css("display","block");
                    $("#sent_document_row").css("display","none");

                    $("#received_document_table tr").remove(); 
                    $("#received_document_table th").remove();
                    $("#page_header").text("Travel Requests"); 

                    $("#documents_sent_button").attr("onclick","getSentTravelRequests()");
                    $("#documents_received_button").attr("onclick","getReceivedTravelRequests()");

                    $.getJSON('/_getStudentTravelRequests',
                    function (documents) {
                        
                        var the_documents = documents.documents
                        var received_documents = false; // Used to determine if there are any received

                        console.log(the_documents);
                        // insertReceivedDocumentTableHeaders()
                        if (the_documents.length == 0){
                          $("#no_received_documents").text("No Received Documents");  
                        }

                        // Checking if there are received documents
                        for (var i = 0; i < the_documents.length; i++){
                            if (the_documents[i].sent_status == "received") {
                                received_documents = true;
                                break;
                            }
                        }

                        if (received_documents){
                            insertRecievedDocumentTableHeaders();
                            for (var i = 0; i < the_documents.length; i++){
                                // console.log(the_documents[i]);
                                doc = the_documents[i]
                                var row = received_document_table_header.insertRow(i+1);
                                for (var j = 0; j < 5; j++){
                                    var cell = row.insertCell(j);
                                    if (j == 0){
                                        cell.innerHTML = "<a href=\"/doc_info?id="+doc.id+"\">"+doc.name+"</a>";
                                    }
                                    if (j == 1){
                                        cell.innerHTML = doc.requester;
                                    }
                                    if (j == 2){
                                        cell.innerHTML = doc.date;
                                    }
                                    if (j == 3){
                                        cell.innerHTML = doc.type;
                                    }
                                    if (j == 4){
                                        cell.innerHTML = doc.status;
                                    }
                                }
                            }
                        }
                        else{
                           $("#no_received_documents").text("No Received Documents"); 
                        }    
                    });
                        
                }  

                // Get the modal
                var modal = document.getElementById('myModal');

                // Get the <span> element that closes the modal
                var span = document.getElementsByClassName("close")[0];

                // When the user clicks on <span> (x), close the modal
                span.onclick = function() {
                    $('#myModal').css("display","none");
                    $('#documents_button').css("display","block");
                    $('#documents_received_button').css("display","block");
                    $('#documents_sent_button').css("display","block");
                }

                // When the user clicks anywhere outside of the modal, close it
                window.onclick = function(event) {
                    if (event.target == modal) {
                        $('#myModal').css("display","none");
                        $('#documents_button').css("display","block");
                        $('#documents_received_button').css("display","block");
                        $('#documents_sent_button').css("display","block");
                    }
                }

                function showAssistantshipModal(){
                    console.log(modal);
                    $('#myModal').css("display","block");
                    $('#documents_button').css("display","none");
                    $('#documents_received_button').css("display","none");
                    $('#documents_sent_button').css("display","none");
                    $("#modal_title").text('New Assistantship Request');
                    $('#modal_body').empty();
                    $('#modal_body').append(" <p>Student Name: Jessica Cotrina Revilla</p><p>Student Number: 502-15-6168</p><p>Department: Electrical Engineering</p><p>Major: Computer Engineering</p><form> <input type=\"text\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\"Advisor\" id=\"advisor\"   value=\"\" required> <br>  <input type=\"text\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\"Project/Class\" id=\"project\"  value=\"\" required> <br> <input type=\"text\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\"Task\" id=\"task\"   value=\"\" required> <br> <select id=\"type\" class=\"form-control\"> <option value=\"research\">Research</option> <option value=\"ta\">TA</option> </select></br> <input  value=\"Create and Send\" onclick=\"insertAssistantshipAndSend()\" class=\"btn btn-lg btn-success\" style=\"color:white; margin-left:325px; background-color: #0DE832\"><input  value=\"Create\" onclick=\"insertAssistantship()\" class=\"btn btn-lg btn-success\" style=\"color:white; display:inline-block; margin-left: 20px\"><br></form>");
                }

                function showTravelModal(){
                    $('#myModal').css("display","block");
                    $('#documents_button').css("display","none");
                    $('#documents_received_button').css("display","none");
                    $('#documents_sent_button').css("display","none");
                    $("#modal_title").text('New Travel Request');
                    $('#modal_body').empty();
                    $('#modal_body').append("<p>Student Name: Jessica Cotrina Revilla</p><p>Student Number: 502-15-6168</p><p>Department: Electrical Engineering</p><p>Major: Computer Engineering</p><form><input type=\"text\" pattern=\"[A-Za-z]\"  class=\"form-control\" placeholder=\"Conference name\" id=\"name\"   value=\"\" required><br><input type=\"text\" pattern=\"[A-Za-z]\"  class=\"form-control\" placeholder=\"Travel Location\" id=\"travelLocation\"   value=\"\" required><br><input type=\"date\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\"Departure Date\" id=\"departureDate\"   value=\"\" required><br><input type=\"date\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\"Return date\" id=\"returnDate\"   value=\"\" required><br><input type=\"text\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\"Advisor\" id=\"advisor\"  value=\"\" required><br><input type=\"text\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\"Purpose\" id=\"purpose\"   value=\"\" required></br><input  value=\"Create and Send\" onclick=\"insertTravelAndSend()\" class=\"btn btn-lg btn-success\" style=\"color:white; margin-left:325px; background-color: #0DE832\"><input  value=\"Create\" onclick=\"insertTravel()\" class=\"btn btn-lg btn-success\" style=\"color:white; display:inline-block; margin-left: 20px\"><br></form>");
                }

                function showSendModal(doc_id){
                    $('#myModal').css("display","block");
                    $('#documents_button').css("display","none");
                    $('#documents_received_button').css("display","none");
                    $('#documents_sent_button').css("display","none");
                    $("#modal_title").text('Send Document');
                    $('#modal_body').empty();

                    console.log(doc_id);
                    // console.log(doc_name);
                    // console.log(user_type);

                    $.getJSON('/_getDocument',{
                            user_type: 0,
                            doc_id: doc_id
                        },
                        function (document) {
                            console.log(document);
                            $("#title").text("\t"+document.name);
                        });


                    $('#modal_body').append("<form role=\"form\">"+
                        "<div class=\"form-group\">"+
                            "<label>Document:</label>"+
                                "<span id=\"title\"></span>"+
                        "</div>" + 
                        "<div class=\"form-group\">"+
                            "<label>To:</label>"+
                            "<input type=\"email\" id=\"email\" class=\"form-control\" placeholder=\"Email\">"+
                        "</div>"+
                        "<div class=\"form-group\">"+
                            "<label>Action:</label>"+
                            "<select id=\"action\">" +
                                "<option value=\"authorize\">Authorize</option>"+
                                "<option value=\"verify\">Verify</option>"+
                            "</select>" +
                        "</div>"+
                        "<div class=\"form-group\">"+
                            "<label>Message:</label>"+
                            "<textarea id=\"message\" class=\"form-control\" rows=\"3\"></textarea>"+
                        "</div>"+
                        
                        "<div \"alert alert-success\">"+ 
                            "<input id=\"doc_id\" type=\"hidden\" value=\""+doc_id+"\"/>"+
                            "<input id=\"1\" type=\"button\" value=\"Send\" class=\"btn btn-success\"  onclick=\"send();\" style=\"margin-left:730px;\"/>"+
                        "</div>"+
                        "</form>");
                }

                function showEditDocumentModal(doc_id){
                    $('#myModal').css("display","block");
                    $('#documents_button').css("display","none");
                    $('#documents_received_button').css("display","none");
                    $('#documents_sent_button').css("display","none");
                    $("#modal_title").text('Edit Document');
                    $('#modal_body').empty();


                    $.getJSON('/_getDocument',{
                            user_type: 0,
                            doc_id: doc_id
                        },
                        function (doc) {
                            // console.log(document);
                            console.log(doc.name) 
                            if (doc.type == "Assistantship Request"){
                                $('#modal_body').append("<p>Document Name: <strong>"+ doc.name +"</strong></p><p>Requested by <strong>"+ doc.requester +"</strong></p><p>Type: <strong>"+ doc.type +"</strong></p><form><label>Project:</label><input type=\"text\" pattern=\"[A-Za-z]\"  class=\"form-control\" placeholder=\""+ doc.project + "\" id=\"project\" value=\"\" required/><br><label>Advisor:</label><input type=\"text\" pattern=\"[A-Za-z]\"  class=\"form-control\" placeholder=\""+ doc.advisor +"\" id=\"advisor\"   value=\"\" required><br><label>Student:</label><input type=\"text\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\""+ doc.student +"\" id=\"student\"   value=\"\" required><br><label>Task:</label><input type=\"text\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\""+ doc.task +"\" id=\"task\"   value=\"\" required><br><input type=\"hidden\" id=\"doc_id\" value="+ doc.id +"><input  value=\"Save and Send\" onclick=\"saveAndSendAssistantship()\" class=\"btn btn-lg btn-success\" style=\"color:white; margin-left:325px; background-color: #0DE832\"><input  value=\"Save\" onclick=\"saveAssistantship()\" class=\"btn btn-lg btn-success\" style=\"color:white; display:inline-block; margin-left: 20px\"><br></form>");
                            }
                            // else{
                            //     $('#modal_body').append("<p>Edited by: Jessica Cotrina Revilla</p><form><label>Document Name:</label><input type=\"text\" pattern=\"[A-Za-z]\"  class=\"form-control\" placeholder=\""+ doc.name+ "\" id=\"doc_name\" value=\"\" required/><br><input type=\"text\" pattern=\"[A-Za-z]\"  class=\"form-control\" placeholder=\""+ doc. +"\" id=\"travelLocation\"   value=\"\" required><br><input type=\"date\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\"Departure Date\" id=\"departureDate\"   value=\"\" required><br><input type=\"date\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\"Return date\" id=\"returnDate\"   value=\"\" required><br><input type=\"text\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\"Advisor\" id=\"advisor\"  value=\"\" required><br><input type=\"text\" pattern=\"[A-Za-z]\" class=\"form-control\" placeholder=\"Purpose\" id=\"purpose\"   value=\"\" required></br><input  value=\"Create and Send\" onclick=\"insertTravelAndSend()\" class=\"btn btn-lg btn-success\" style=\"color:white; margin-left:325px; background-color: #0DE832\"><input  value=\"Create\" onclick=\"insertTravel()\" class=\"btn btn-lg btn-success\" style=\"color:white; display:inline-block; margin-left: 20px\"><br></form>");
                            // }
                    });

                    console.log(doc);   
                }

                function insertAssistantship(){
                    var advisor = $('#advisor').val();
                    var project = $('#project').val();
                    var task    = $('#task').val();
                    var a_type  = $('#type option:selected').text(); 
                    console.log(advisor);
                    console.log(project);
                    console.log(task);
                    console.log(a_type);
                    if (advisor.length > 1 && project.length > 1 && task.length > 1 && a_type.length > 1){
                        $.getJSON('/_insertAssistantship',{
                            user_type: 0,
                            advisor:   advisor,
                            project:   project,
                            task:      task,
                            a_type:    a_type,
                            student:   "Jessica Cotrina", 
                        },
                        function (created) {
                            if (created.status == 0){
                                alert("Assistantship succesfully created!");
                                $('#myModal').css("display","none");
                                window.location.assign("/student");
                            }
                            else{
                                alert("ERROR: Could not create assistantship!");
                            }

                        });
                    }
                    else{
                        alert("ERROR: Please fill al the fields!");
                    }
                    
                }

                function insertAssistantshipAndSend(){
                    var advisor = $('#advisor').val();
                    var project = $('#project').val();
                    var task    = $('#task').val();
                    var a_type  = $('#type option:selected').text(); 
                    if (advisor.length >= 1 && project.length >= 1 && task.length >= 1 && a_type.length > 1){
                        $.getJSON('/_insertAssistantship',{
                            user_type: 0,
                            advisor:   advisor,
                            project:   project,
                            task:      task,
                            a_type:    a_type,
                            student:   "Jessica Cotrina", 
                        },
                        function (created) {
                            console.log(created);
                            if (created.status == 0){
                                alert("Assistantship succesfully created!");
                                $('#myModal').css("display","none");
                                showSendModal(created.id);
                            }
                            else{
                                alert("ERROR: Could not create assistantship!");
                            }

                        });
                    }
                    else{
                        alert("ERROR: Please fill al the fields!");
                    }
                    
                }

                function insertTravel(){
                    var name = $('#name').val();
                    var travel_location = $('#travelLocation').val();
                    var departure_date    = $('#departureDate').val();
                    var return_date = $('#returnDate').val(); 
                    var advisor    = $('#advisor').val();
                    var purpose = $('#purpose').val();
                    if (name.length > 1 && travel_location.length > 1 && departure_date.length > 1 && return_date.length > 1 && advisor.length > 1 && purpose.length > 1){
                        $.getJSON('/_insertTravelRequest',{
                            user_type: 0,
                            conference_name: name,
                            travel_location: travel_location,
                            departure_date: departure_date,
                            return_date: return_date,
                            advisor: advisor,
                            purpose: purpose, 
                            requester: "Jessica Cotrina"
                        },
                        function (created) {
                            if (created.status == 0){
                                alert("Travel request succesfully created!");
                                $('#myModal').css("display","none");
                                window.location.assign("/student");
                            }
                            else{
                                alert("ERROR: Could not create Travel Request!");
                            }

                        });
                    }
                    else{
                        alert("ERROR: Please fill al the fields!");
                    }
                    
                }

                function insertTravelAndSend(){
                    var name = $('#name').val();
                    var travel_location = $('#travelLocation').val();
                    var departure_date    = $('#departureDate').val();
                    var return_date = $('#returnDate').val(); 
                    var advisor    = $('#advisor').val();
                    var purpose = $('#purpose').val();
                    if (name.length > 1 && travel_location.length > 1 && departure_date.length > 1 && return_date.length > 1 && advisor.length > 1 && purpose.length > 1){
                        $.getJSON('/_insertTravelRequest',{
                            user_type: 0,
                            conference_name: name,
                            travel_location: travel_location,
                            departure_date: departure_date,
                            return_date: return_date,
                            advisor: advisor,
                            purpose: purpose,
                            requester: "Jessica Cotrina"
                        },
                        function (created) {
                            console.log(created);
                            if (created.status == 0){
                                alert("Travel request succesfully created!");
                                $('#myModal').css("display","none");
                                showSendModal(created.id);
                            }
                            else{
                                alert("ERROR: Could not create travel request!");
                            }

                        });
                    }
                    else{
                        alert("ERROR: Please fill al the fields!");
                    }
                    
                }

                function send() {
                    var email = $("#email").val();
                    var message = $("#message").val();
                    var doc_id = $('#doc_id').val();
                    var action  = $('#action option:selected').text(); 
                    console.log(email);
                    console.log(message);
                    console.log(doc_id);
                    console.log(action);
                    if (email == "nestor.rodriguez@upr.edu" || email == "alida.minguela@upr.edu" || email == "jose.colom@upr.edu"){

                        // Student sending document case
                        if (email == "nestor.rodriguez@upr.edu"){
                            $.getJSON('/_sendDocument', 
                                { doc_id: doc_id,
                                  user_type: 0,
                                  sent_to: email,
                                  message: message,
                                  action: action
                                },
                                function (sent) {
                                    console.log(sent)
                                    if (sent.status == 0){
                                        alert("Document Sent!");
                                        window.location.assign("/student");
                                    }
                                    else {
                                        alert("ERROR! Cannot send document to \""+email+"\"");
                                        console.log(sent);
                                    }
                              });
                        }

                        else if (email == "alida.minguela@upr.edu"){
                            console.log("Enviando a Alida");
                            $.getJSON('/_sendDocument', 
                                { doc_id: doc_id,
                                  user_type: 0,
                                  sent_to: email,
                                  message: message,
                                  action: action
                                },
                                function (sent) {
                                    console.log(sent)
                                    if (sent.status == 0){
                                        alert("Document Sent!");
                                        window.location.assign("/student");
                                    }
                                    else {
                                        alert("ERROR! Cannot send document to \""+email+"\"");
                                        console.log(sent);
                                    }
                              });
                        }

                        else if (email == "jose.colom@upr.edu"){
                            $.getJSON('/_sendDocument', 
                                { doc_id: doc_id,
                                  user_type: 0,
                                  sent_to: email,
                                  message: message,
                                  action: action
                                },
                                function (sent) {
                                    console.log(sent)
                                    if (sent.status == 0){
                                        alert("Document Sent!");
                                        window.location.assign("/student");
                                    }
                                    else {
                                        alert("ERROR! Cannot send document to \""+email+"\"");
                                        console.log(sent);
                                    }
                              });
                        }

                    
                        else {
                            alert("ERROR! Cannot send document to \""+email+"\"");
                        }  

                    }  

                    else {
                        alert("ERROR! Cannot send document to \""+email+"\"");
                    }               
                }

                function saveAssistantship(){
                    var doc_id = $("#doc_id").val();
                    var project = $("#project").val();
                    var advisor = $("#advisor").val();
                    var student = $("#student").val();
                    var task = $("#task").val();
                    console.log(doc_id);
                    console.log(project);
                    console.log(advisor);
                    console.log(student);
                    console.log(task);
                    if (project.length > 0 && advisor.length > 0 && student.length > 0 && task.length >0){
                        $.getJSON('/_saveAssistantship',{
                            user_type: 0,
                            doc_id: doc_id,
                            project: project,
                            advisor: advisor,
                            student: student,
                            task: task
                        },
                        function (saved) {
                            console.log(saved);
                            if (saved.status == 0){
                                alert("Document updated");
                                $("#myModal").css("display","none");
                            }
                            else{
                                alert("ERROR: Could not update document!")
                            }
                            
                        });
                    }
                    else{
                        $("#myModal").css("display","none");
                    }
                    
                }

                function saveAndSendAssistantship(){
                    var doc_id = $("#doc_id").val();
                    var project = $("#project").val();
                    var advisor = $("#advisor").val();
                    var student = $("#student").val();
                    var task = $("#task").val();
                    console.log(doc_id);
                    console.log(project);
                    console.log(advisor);
                    console.log(student);
                    console.log(task);
                    if (project.length > 0 && advisor.length > 0 && student.length > 0 && task.length >0){
                        $.getJSON('/_saveAssistantship',{
                            user_type: 0,
                            doc_id: doc_id,
                            project: project,
                            advisor: advisor,
                            student: student,
                            task: task
                        },
                        function (saved) {
                            console.log(saved);
                            if (saved.status == 0){
                                alert("Document updated");
                                $("#myModal").css("display","none");
                                showSendModal(saved.doc_id);
                            }
                            else{
                                alert("ERROR: Could not update document!")
                            }

                            
                        });
                    }
                    else{
                        $("#myModal").css("display","none");
                    }
                }

                function saveTravelRequest(){
                    var doc_id = $("#doc_id").val();
                    var project = $("#project").val();
                    var advisor = $("#advisor").val();
                    var student = $("#student").val();
                    var task = $("#task").val();
                    console.log(doc_id);
                    console.log(project);
                    console.log(advisor);
                    console.log(student);
                    console.log(task);
                    // if (project.length > 0 && advisor.length > 0 && student.length > 0 && task.length >0){
                    //     $.getJSON('/_saveAssistantship',{
                    //         user_type: 0,
                    //         doc_id: doc_id,
                    //         project: project,
                    //         advisor: advisor,
                    //         student: student,
                    //         task: task
                    //     },
                    //     function (saved) {
                    //         console.log(saved);
                    //         if (saved.status == 0){
                    //             alert("Document updated");
                    //             $("#myModal").css("display","none");
                    //         }
                    //         else{
                    //             alert("ERROR: Could not update document!")
                    //         }
                            
                    //     });
                    // }
                    // else{
                    //     $("#myModal").css("display","none");
                    // }
                    
                }

                function saveAndSendTravelRequest(){
                    var doc_id = $("#doc_id").val();
                    var project = $("#project").val();
                    var advisor = $("#advisor").val();
                    var student = $("#student").val();
                    var task = $("#task").val();
                    console.log(doc_id);
                    console.log(project);
                    console.log(advisor);
                    console.log(student);
                    console.log(task);
                    // if (project.length > 0 && advisor.length > 0 && student.length > 0 && task.length >0){
                    //     $.getJSON('/_saveAssistantship',{
                    //         user_type: 0,
                    //         doc_id: doc_id,
                    //         project: project,
                    //         advisor: advisor,
                    //         student: student,
                    //         task: task
                    //     },
                    //     function (saved) {
                    //         console.log(saved);
                    //         if (saved.status == 0){
                    //             alert("Document updated");
                    //             $("#myModal").css("display","none");
                    //             showSendModal(saved.doc_id);
                    //         }
                    //         else{
                    //             alert("ERROR: Could not update document!")
                    //         }

                            
                    //     });
                    // }
                    // else{
                    //     $("#myModal").css("display","none");
                    // }
                }

            </script>
        </div>  
        <!-- /#wrapper -->
    </div>
    
</body>

</html>
